# Wrapper patterns - safe prefixes that can wrap any safe command
# These are stripped from the command before checking if the core command is safe

[[wrapper]]
pattern = '^timeout\s+\d+\s+'
name = "timeout"

[[wrapper]]
pattern = '^nice\s+(-n\s*\d+\s+)?'
name = "nice"

[[wrapper]]
pattern = '^env\s+'
name = "env"

[[wrapper]]
pattern = '^([A-Z_][A-Z0-9_]*=[^\s]*\s+)+'
name = "env vars"

# Virtual env paths: .venv/bin/, ../.venv/bin/, venv/bin/
[[wrapper]]
pattern = '^(\.\./)*\.?venv/bin/'
name = ".venv"

# Absolute path to venv: /abs/path/.venv/bin/
[[wrapper]]
pattern = '^/[^\s]+/\.?venv/bin/'
name = ".venv"

# do (loop body prefix)
[[wrapper]]
pattern = '^do\s+'
name = "do"
