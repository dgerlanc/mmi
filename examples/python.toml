# Python development MMI configuration

# Deny dangerous commands
[[deny.simple]]
name = "privilege escalation"
commands = ["sudo", "su", "doas"]

[[deny.regex]]
pattern = 'rm\s+(-[rRfF]+\s+)*/'
name = "rm root"

# Wrappers
[[wrappers.simple]]
name = "env"
commands = ["env"]

[[wrappers.command]]
command = "timeout"
flags = ["<arg>"]

[[wrappers.regex]]
pattern = '^([A-Z_][A-Z0-9_]*=[^\s]*\s+)+'
name = "env vars"

[[wrappers.regex]]
pattern = '^(\.\./)*\.?venv/bin/'
name = ".venv"

[[wrappers.regex]]
pattern = '^/[^\s]+/\.?venv/bin/'
name = ".venv"

# Python tools
[[commands.simple]]
name = "python"
commands = ["python", "python3", "pytest", "ruff", "mypy", "black", "isort", "pip", "uvx"]

[[commands.subcommand]]
command = "uv"
subcommands = ["pip", "run", "sync", "venv", "add", "remove", "lock", "build"]

[[commands.subcommand]]
command = "pip"
subcommands = ["install", "uninstall", "list", "show", "freeze"]

# Virtual environment activation
[[commands.regex]]
pattern = '^(source|\.) [^\s]*venv/bin/activate'
name = "venv activate"

# Git
[[commands.subcommand]]
command = "git"
subcommands = ["diff", "log", "status", "show", "branch", "stash", "fetch", "add", "checkout", "merge", "rebase", "commit"]
flags = ["-C <arg>"]

# Read-only utilities
[[commands.simple]]
name = "read-only"
commands = ["ls", "cat", "head", "tail", "grep", "find", "wc", "file", "which", "pwd"]

# Common utilities
[[commands.simple]]
name = "common"
commands = ["make", "touch", "echo", "sleep"]

# Shell builtins
[[commands.regex]]
pattern = '^(true|false|exit(\s+\d+)?)$'
name = "shell builtin"

[[commands.regex]]
pattern = '^cd\s'
name = "cd"

[[commands.regex]]
pattern = '^[A-Z_][A-Z0-9_]*=\S*$'
name = "var assignment"
